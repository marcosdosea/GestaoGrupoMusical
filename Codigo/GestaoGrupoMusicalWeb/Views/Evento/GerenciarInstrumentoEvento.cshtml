@model GestaoGrupoMusicalWeb.Models.GerenciarInstrumentoEventoViewModel
@{
    ViewData["Title"] = "Gerenciar Instrumento Evento";
    ViewData["Evento"] = "Eventos";
    ViewData["GerenciarInstrumentoEvento"] = "Gerenciar Instrumento";
}

<partial name="_Notificar">
    <div class="row">
        <div class="col-md-8">
            <h1 class="p-3 bg-danger  bg-opacity-75 text-white fs-5">Gerenciar Instrumento do Evento Musical</h1>
            <nav>
                <ol class="breadcrumb px-3">
                    <strong>
                        <a class="text-danger text-opacity-75" asp-action="Index">@ViewData["Evento"]</a>
                        <spn class="text-secondary"><i class="text-dark fa-sharp fa-solid fa-angle-right fa-xs"></i> @ViewData["GerenciarInstrumentoEvento"]</spn>
                    </strong>
                </ol>
            </nav>
            <hr />
            <br />
            <div class="container">
                <div class="row">
                    <div class="col-xxl-4">
                        <label asp-for="DataHoraInicio" class="control-label"></label>
                        <input asp-for="DataHoraInicio" class="form-control" readonly />
                        <span asp-validation-for="DataHoraInicio" class="text-danger"></span>
                    </div>
                    <div class="col-xxl-4">
                        <label asp-for="DataHoraFim" class="control-label"></label>
                        <input asp-for="DataHoraFim" class="form-control" readonly />
                        <span asp-validation-for="DataHoraFim" class="text-danger"></span>
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row col-xl">
                    <div >
                        <label asp-for="IdRegentes" class="control-label"></label>
                        <select asp-for="IdRegentes" asp-items="@Model.ListaPessoa" class="form-select" readonly>
                            <option value=""></option>
                        </select>
                        <span asp-validation-for="IdRegentes" class="text-danger"></span>
                    </div>                    
                </div>
            </div>
            <div class="container">                
                <div>
                    <label asp-for="IdFigurinoSelecionado" class="control-label"></label>
                    <select asp-items="@Model.FigurinoList" class="form-select" readonly></select>                    
                </div>
            </div>
            <div class="container">
                <div>
                    <label asp-for="Local" class="control-label"></label>
                    <input asp-for="Local" class="form-control" readonly />
                    <span asp-validation-for="Local" class="text-danger"></span>
                </div>
            </div>
            <form asp-action="CreateInstrumento">               
                <div class="container">
                    <div class="row col-md-12">                      
                        <div class="form-group  col-md-4">
                            <label asp-for="ListaInstrumentos" class="control-label"></label>
                            <select asp-for="IdTipoInstrumento" asp-items="@Model.ListaInstrumentos" class="form-select">                                
                            </select>                                                        
                        </div>                                    
                        <div class="form-group  col-md-4">
                            <label asp-for="Quantidade" class="control-label"></label>
                            <input asp-for="Quantidade" class="form-control" min="0" oninput="validity.valid||(value='');" />                            
                        </div>
                        <div class="form-group" hidden>
                            <label asp-for="Id" class="control-label"></label>
                            <input asp-for="Id" class="form-control" />
                        </div>
                        <div class="form-group col-md-4 justify-content-lg-end flex-column-reverse flex-lg-row">
                            <input class="btn btn-secondary  btn-lg w-100 mt-3" type="submit" value="Adicionar" />
                        </div>
                    </div>
                </div>
            </form>
            <br />
            <br />
            <div class="table-responsive">
                <table class="table mt-3">
                    <thead>
                        <tr class="bg-danger bg-opacity-75 text-white">
                            <th>
                                @Html.DisplayNameFor(model => model.ListaInstrumentos)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Planejados)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Solicitados)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Confirmados)
                            </th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>

                        @{
                            for (int i = 0; i < Model.InstrumentosPlanejadoEventoDTO.Count; i++)
                            {
                                <tr class="border-bottom border-danger border-opacity-75 align-middle">
                                    <td>
                                        @Html.DisplayFor(model => Model.InstrumentosPlanejadoEventoDTO[i].Instrumentos)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(model => Model.InstrumentosPlanejadoEventoDTO[i].Planejado)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(model => Model.InstrumentosPlanejadoEventoDTO[i].Solicitados)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(model => Model.InstrumentosPlanejadoEventoDTO[i].Confirmados)
                                    </td>
                                    <td class="py-3 border-0 d-flex flex-column flex-lg-row gap-3">
                                        <form id="@( Model.InstrumentosPlanejadoEventoDTO[i].IdInstrumento + "_notificar")" asp-controller="InstrumentoMusical" asp-action="NotificarViaEmail" asp-route-Id="@Model.InstrumentosPlanejadoEventoDTO[i].IdInstrumento" asp-route-IdInstrumento="@Model.InstrumentosPlanejadoEventoDTO[i].IdInstrumento" method="post">
                                            <a role="button" class="btn btn-sm btn-secondary"
                                               data-bs-toggle="modal" data-bs-target="#notificarMovimentacaoModal"
                                               onclick="showModal('@(Model.InstrumentosPlanejadoEventoDTO[i].IdInstrumento + "_notificar")', 'notificarMovimentacaoModal')">
                                                <i class="fa-solid fa-envelope"></i>
                                                Notificar
                                            </a>
                                        </form>
                                        <form id="@(Model.InstrumentosPlanejadoEventoDTO[i].IdInstrumento + "_delete")" asp-controller="InstrumentoMusical" asp-action="DeleteMovimentacao" asp-route-Id="@Model.InstrumentosPlanejadoEventoDTO[i].IdInstrumento" asp-route-IdInstrumento="@Model.InstrumentosPlanejadoEventoDTO[i].IdInstrumento" method="post">
                                            <a role="button" class="btn btn-sm btn-secondary"
                                               data-bs-toggle="modal" data-bs-target="#excluirMovimentacaoModal"
                                               onclick="showModal('@(Model.InstrumentosPlanejadoEventoDTO[i].IdInstrumento + "_delete")', 'excluirMovimentacaoModal')">
                                                <i class="fa-solid fa-xmark"> </i>
                                                Excluir
                                            </a>
                                        </form>
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>                    
                </table>

                <p class="text-center mt-4 mb-0">Desculpe, nenhuma movimentação encontrada :(</p>

            </div>

            <div class="modal fade" id="excluirMovimentacaoModal" tabindex="-1" aria-labelledby="excluirMovimentacaoLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="excluirMovimentacaoLabel">Excluir Movimentação</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            Deseja <b>Excluir</b> essa <b>Movimentação</b>?
                        </div>
                        <form method="post" class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary col-3 me-4" data-bs-dismiss="modal">Não</button>
                            <button type="submit" class="btn btn-secondary col-3">Sim</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="notificarMovimentacaoModal" tabindex="-1" aria-labelledby="notificarMovimentacaoLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="notificarMovimentacaoLabel">Notificar Movimentação</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            Deseja <b>Notificar</b> o <b>Associado</b> da necessidade de <b>Confirmação</b>?
                        </div>
                        <form method="post" class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary col-3 me-4" data-bs-dismiss="modal">Não</button>
                            <button type="submit" class="btn btn-secondary col-3">Sim</button>
                        </form>
                    </div>
                </div>
            </div>
                <div class="row">
                    <div class="d-flex justify-content-lg-end flex-column-reverse flex-lg-row">
                        <a class="btn btn-outline-secondary col-lg-2 mt-3 me-lg-3 btn-" asp-controller="Evento" asp-action="Index">Voltar</a>
                    </div>
                </div>
        </div>
    </div>
    @section Header {
        @{
            await Html.RenderPartialAsync("_AutoCompleteCssPartial");
        }
    }
    @section Scripts {
        @{
            await Html.RenderPartialAsync("_ValidationScriptsPartial");
            await Html.RenderPartialAsync("_EnablePopoversPartial");
            await Html.RenderPartialAsync("_AutoCompletePartial");
        }
    }
